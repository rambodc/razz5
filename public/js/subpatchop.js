(()=>{const t="Ops.Ui.SubPatchInput",a="Ops.Ui.SubPatchOutput";CABLES.SubPatchOp=class{constructor(t,a){a=a||{},this._op=t,t.patchId=t.addInPort(new CABLES.Port(t,"patchId",CABLES.OP_PORT_TYPE_STRING,{display:"readonly",hidePort:!0})),t.setUiAttribs({subPatchOp:{version:2}}),t.uiAttribs.parentOfSubpatch?t.patchId.set(t.uiAttribs.parentOfSubpatch):a.subId?t.patchId.set(a.subId):t.patchId.set(CABLES.generateUUID()),t.patchId.onChange=()=>{a.subId&&(t.patchId.value=a.subId)},t.patch.on("subpatchCreated",(()=>{this.createInOutOps()})),t.on("loadedValueSet",(()=>{this.createInOutOps()})),t.init=()=>{t.setStorage({subPatchVer:2})},t.loadDependencies=(t,a)=>{CABLES.UI?gui.serverOps.loadProjectDependencies(t,(()=>{a&&a()})):a&&a()},t.on("delete",(()=>{t.patch.clearSubPatchCache&&t.patch.clearSubPatchCache(this.patchId);const a=t.patch.ops;for(let h=a.length-1;h>=0;h--)a[h]&&a[h].uiAttribs&&a[h].uiAttribs.subPatch==t.patchId.get()&&t.patch.deleteOp(a[h].id)})),this._op.isExposableSubpatchOp=()=>!0}get patchId(){return this._op.patchId.get()}createInOutOps(){this._op.patch.clearSubPatchCache&&this._op.patch.clearSubPatchCache(this.patchId);let h=this._op.patch.getSubPatchOp(this.patchId,t),e=this._op.patch.getSubPatchOp(this.patchId,a);h||this._op.patch.addOp(t,{subPatch:this.patchId,translate:{x:0,y:0}}),e||this._op.patch.addOp(a,{subPatch:this.patchId,translate:{x:0,y:0}})}},((this.CABLES=this.CABLES||{}).COREMODULES=this.CABLES.COREMODULES||{}).Subpatchop={}.Cables})();